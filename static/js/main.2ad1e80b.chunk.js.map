{"version":3,"sources":["useFFMPEG.js","dots.jsx","UploadButton.jsx","ConvertProgress.jsx","OutputVideo.jsx","SelectedFiles.jsx","Output.jsx","App.jsx","reportWebVitals.js","index.js"],"names":["ffmpeg","Dots","props","useState","dots","setDots","useEffect","timer","setInterval","length","maxNumber","interval","clearInterval","wasmEnabled","window","isSecureContext","createFFmpeg","log","UploadButton","onChange","text","className","fill","height","viewBox","width","xmlns","d","type","accept","multiple","ConvertProgress","progress","OutputVideo","url","controls","src","href","download","SelectedFiles","images","Output","videoUrl","App","loaded","setLoaded","converting","setConverting","setProgress","setVideoUrl","setImages","framerate","setFramerate","convertToStopMotion","a","filePromises","map","image","fetchFile","Promise","all","imageFiles","i","FS","name","run","data","URL","createObjectURL","Blob","buffer","isLoaded","load","ratio","useFFMPEG","e","Array","from","target","files","id","value","parseFloat","onClick","disabled","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2ad1e80b.chunk.js","sourcesContent":["import {createFFmpeg, fetchFile} from \"@ffmpeg/ffmpeg\";\nimport {useEffect, useState} from \"react\";\n\nlet wasmEnabled = true;\nlet ffmpeg;\nif (window.isSecureContext) {\n    ffmpeg = createFFmpeg({log: true});\n} else {\n    wasmEnabled = false;\n    // TODO\n}\n\nexport const useFFMPEG = () => {\n    const [loaded, setLoaded] = useState(false);\n    const [converting, setConverting] = useState(false);\n    const [progress, setProgress] = useState(null);\n    const [videoUrl, setVideoUrl] = useState(null);\n    const [images, setImages] = useState([]);\n    const [framerate, setFramerate] = useState(1);\n    let convertToStopMotion = wasmEnabled ?\n        async () => {\n            setConverting(true);\n\n            const filePromises = images.map(image => fetchFile(image));\n            const imageFiles = await Promise.all(filePromises);\n            for (let i = 0; i < imageFiles.length; i++) {\n                ffmpeg.FS('writeFile', images[i].name, imageFiles[i]);\n            }\n            await ffmpeg.run('-framerate', `${framerate}`, '-pattern_type', 'glob', '-i', '*.jpg', '-c:v', 'libx264', '-vf', 'scale=1920:1080', 'out.mp4');\n            const data = ffmpeg.FS('readFile', 'out.mp4');\n            const url = URL.createObjectURL(new Blob([data.buffer], {type: 'video/mp4'}));\n            setVideoUrl(url);\n            setConverting(false);\n        }\n        : async () => {\n        // TODO\n        };\n    useEffect(() => {\n        if (wasmEnabled) {\n            (async () => {\n                if (!ffmpeg.isLoaded()) {\n                    await ffmpeg.load();\n                    ffmpeg.setProgress(({ratio}) => {\n                        setProgress(ratio * 100);\n                    });\n                    setLoaded(true);\n                }\n            })();\n        } else {\n            // TODO\n        }\n    }, []);\n    return {\n        loaded,\n        converting,\n        progress,\n        framerate,\n        setFramerate,\n        videoUrl,\n        images,\n        setImages,\n        convertToStopMotion,\n    }\n}","import React, {useState, useEffect} from 'react';\n\nexport const Dots = (props) => {\n    const [dots, setDots] = useState('.');\n\n    useEffect(() => {\n        const timer = setInterval(() => {\n            if(dots.length >= props.maxNumber) {\n                setDots('.');\n            } else {\n                setDots(dots + '.');\n            }\n        }, props.interval);\n        return () => {\n            clearInterval(timer);\n        };\n    });\n\n    return (\n        <span>{dots}</span>\n    );\n}","import React from 'react';\n\nexport const UploadButton = ({onChange, text}) => {\n    return (\n        <div className=\"form__field overflow-hidden relative bg-purple-500 hover:bg-purple-900\">\n            <button\n                className=\"button--upload\">\n                <svg fill=\"#FFF\" height=\"18\" viewBox=\"0 0 24 24\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                    <path d=\"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z\"/>\n                </svg>\n                <span className=\"ml-2\">{text}</span>\n            </button>\n            <input type=\"file\" accept=\"image/jpeg\" multiple={true}\n                   className=\"form__input--upload\"\n                    onChange={onChange}/>\n        </div>\n    );\n}","import React from 'react';\n\nexport const ConvertProgress = ({progress}) => {\n    return (\n        <p>{progress} / 100</p>\n    );\n}","import React from 'react';\n\nexport const OutputVideo = ({url}) => (\n    <div className=\"form\">\n        <video controls src={url} className=\"output__video\"/>\n        <a className=\"form__field button button--secondary\" href={url} download={true}>Download</a>\n    </div>\n)","import React from 'react';\n\nexport const SelectedFiles = ({images}) => (\n    <div className=\"flex\">\n        Selected {images.length} files\n    </div>\n)","import React from 'react';\nimport {ConvertProgress} from \"./ConvertProgress\";\nimport {OutputVideo} from \"./OutputVideo\";\nimport {SelectedFiles} from \"./SelectedFiles\";\nexport const Output = ({progress, videoUrl, images}) => {\n    return (\n        <div className=\"output\">\n            {progress && <ConvertProgress progress={progress}/>}\n            {videoUrl && <OutputVideo url={videoUrl}/>}\n            <SelectedFiles images={images}/>\n        </div>\n    );\n}","import React from \"react\";\nimport {Dots} from \"./dots\";\nimport {useFFMPEG} from \"./useFFMPEG\";\nimport {UploadButton} from \"./UploadButton\";\nimport {Output} from \"./Output\";\n\nfunction App() {\n    const {\n        loaded,\n        framerate,\n        setFramerate,\n        images,\n        setImages,\n        converting,\n        convertToStopMotion,\n        progress,\n        videoUrl,\n    } = useFFMPEG();\n\n    return loaded ? (\n            <div className=\"app app__content\">\n                <div className=\"card\">\n                    <header className=\"card__header\">\n                        Stop motion maker\n                    </header>\n                    <div className=\"card__content\">\n                        <div className=\"form\">\n                            <UploadButton onChange={(e) => setImages(Array.from(e.target.files))}\n                                          text=\"Choose files to convert\"/>\n                            <div className=\"form__field\">\n                                <label className=\"form__label\">Framerate</label>\n                                <input type=\"number\" id=\"framerate\" name=\"framerate\" value={framerate}\n                                       onChange={(e) => setFramerate(parseFloat(e.target.value))}\n                                       className=\"form__input\"/>\n                            </div>\n                            <button onClick={convertToStopMotion} disabled={converting}\n                                    className={\"button button--secondary \" + (converting ? 'button--disabled' : '')}>Convert\n                            </button>\n                        </div>\n                        <Output progress={progress} images={images} videoUrl={videoUrl}/>\n                    </div>\n                </div>\n            </div>\n        ) :\n        (\n            <div>\n                <p>\n                    Make sure you are running a browser that <a href=\"https://caniuse.com/sharedarraybuffer\">supports\n                    SharedArrayBuffer</a>\n                </p>\n                <p>\n                    Loading FFMPEG module, this can take some time<Dots maxNumber={3} interval={250}/>\n                </p>\n            </div>\n        );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.scss';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}